# ğŸ”’ ë³´ì•ˆ ê°€ì´ë“œ

## âš ï¸ ì¤‘ìš”: API í‚¤ ë³´ì•ˆ

í˜„ì¬ í”„ë¡œì íŠ¸ëŠ” Supabase API í‚¤ê°€ `/utils/supabase/info.tsx` íŒŒì¼ì— í•˜ë“œì½”ë”©ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

### í˜„ì¬ ìƒíƒœ

```typescript
// /utils/supabase/info.tsx
export const projectId = "ucoghecfsnphdguexbiv"
export const publicAnonKey = "eyJhbGci..."
```

### ë¬¸ì œì 

1. **GitHubì— ë…¸ì¶œ**: ì½”ë“œë¥¼ GitHubì— í‘¸ì‹œí•˜ë©´ API í‚¤ê°€ ê³µê°œë©ë‹ˆë‹¤
2. **ë³´ì•ˆ ìœ„í—˜**: ëˆ„êµ¬ë‚˜ í•´ë‹¹ í‚¤ë¡œ Supabaseì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
3. **í‚¤ êµì²´ ì–´ë ¤ì›€**: í•˜ë“œì½”ë”©ëœ í‚¤ë¥¼ ë³€ê²½í•˜ë ¤ë©´ ì½”ë“œ ìˆ˜ì • í•„ìš”

---

## ğŸ›¡ï¸ ê¶Œì¥ ë³´ì•ˆ ì¡°ì¹˜

### ë°©ë²• 1: í™˜ê²½ ë³€ìˆ˜ë¡œ ë³€ê²½ (ê¶Œì¥)

#### 1ë‹¨ê³„: ì½”ë“œ ìˆ˜ì •

`/utils/supabase/info.tsx` íŒŒì¼ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •:

```typescript
/* AUTOGENERATED FILE - DO NOT EDIT CONTENTS */

export const projectId = import.meta.env.VITE_SUPABASE_PROJECT_ID || "";
export const publicAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY || "";
```

#### 2ë‹¨ê³„: ë¡œì»¬ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env.local` íŒŒì¼ ìƒì„±:

```bash
VITE_SUPABASE_PROJECT_ID=ucoghecfsnphdguexbiv
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVjb2doZWNmc25waGRndWV4Yml2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY4NjI2NDQsImV4cCI6MjA3MjQzODY0NH0.sSCxnOQvmAxROvvAKf3AP9pJTPtVQQ48YDFweXwjslI
```

#### 3ë‹¨ê³„: Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

Vercel ëŒ€ì‹œë³´ë“œ â†’ í”„ë¡œì íŠ¸ â†’ Settings â†’ Environment Variablesì—ì„œ ë™ì¼í•œ ë³€ìˆ˜ ì¶”ê°€

---

### ë°©ë²• 2: GitHub Private ì €ì¥ì†Œ ì‚¬ìš©

ê³µê°œ ì €ì¥ì†Œ ëŒ€ì‹  Private ì €ì¥ì†Œë¥¼ ì‚¬ìš©í•˜ì—¬ ì½”ë“œë¥¼ ë³´í˜¸í•©ë‹ˆë‹¤.

**ì¥ì **:
- ê°„ë‹¨í•˜ê³  ë¹ ë¦„
- ì½”ë“œ ìˆ˜ì • ë¶ˆí•„ìš”

**ë‹¨ì **:
- í˜‘ì—… ì‹œ ì ‘ê·¼ ê¶Œí•œ ê´€ë¦¬ í•„ìš”
- í‚¤ê°€ ì—¬ì „íˆ ì½”ë“œì— í•˜ë“œì½”ë”©ë¨

---

## ğŸ”‘ Supabase RLS (Row Level Security)

Supabaseì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ë³´ì•ˆì„ ê°•í™”í•˜ë ¤ë©´ RLSë¥¼ í™œì„±í™”í•˜ì„¸ìš”.

### KV Store í…Œì´ë¸” ë³´ì•ˆ

1. Supabase ëŒ€ì‹œë³´ë“œ â†’ Database â†’ Tables â†’ `kv_store_cb50e858`
2. RLS í™œì„±í™” (Enable RLS)
3. ì •ì±… ì¶”ê°€:

```sql
-- ì½ê¸° í—ˆìš© (ëª¨ë“  ì‚¬ìš©ì)
CREATE POLICY "Enable read access for all users" ON kv_store_cb50e858
FOR SELECT USING (true);

-- ì“°ê¸° í—ˆìš© (ì¸ì¦ëœ ì‚¬ìš©ì ë˜ëŠ” ì„œë¹„ìŠ¤ ì—­í• ë§Œ)
CREATE POLICY "Enable write access for authenticated users" ON kv_store_cb50e858
FOR INSERT WITH CHECK (auth.role() = 'authenticated' OR auth.role() = 'service_role');

CREATE POLICY "Enable update access for authenticated users" ON kv_store_cb50e858
FOR UPDATE USING (auth.role() = 'authenticated' OR auth.role() = 'service_role');

CREATE POLICY "Enable delete access for authenticated users" ON kv_store_cb50e858
FOR DELETE USING (auth.role() = 'authenticated' OR auth.role() = 'service_role');
```

---

## ğŸ—„ï¸ Storage ë³´ì•ˆ

### ë²„í‚· ì •ì±… ì„¤ì •

1. Supabase ëŒ€ì‹œë³´ë“œ â†’ Storage â†’ `sinsuru` ë²„í‚·
2. "Policies" íƒ­
3. ì •ì±… ì¶”ê°€:

#### ì½ê¸° í—ˆìš© (ëª¨ë“  ì‚¬ìš©ì)

```sql
CREATE POLICY "Public read access" ON storage.objects
FOR SELECT USING (bucket_id = 'sinsuru');
```

#### ì“°ê¸° ì œí•œ (ì¸ì¦ëœ ì‚¬ìš©ìë§Œ)

```sql
CREATE POLICY "Authenticated write access" ON storage.objects
FOR INSERT WITH CHECK (
  bucket_id = 'sinsuru' AND 
  auth.role() = 'authenticated'
);

CREATE POLICY "Authenticated update access" ON storage.objects
FOR UPDATE USING (
  bucket_id = 'sinsuru' AND 
  auth.role() = 'authenticated'
);

CREATE POLICY "Authenticated delete access" ON storage.objects
FOR DELETE USING (
  bucket_id = 'sinsuru' AND 
  auth.role() = 'authenticated'
);
```

---

## ğŸš« ì ˆëŒ€ ê³µê°œí•˜ë©´ ì•ˆ ë˜ëŠ” ê²ƒë“¤

### âŒ ì ˆëŒ€ GitHubì— ì»¤ë°‹í•˜ë©´ ì•ˆ ë¨:

1. `SUPABASE_SERVICE_ROLE_KEY` - ìŠˆí¼ ê´€ë¦¬ì ê¶Œí•œ
2. `.env.local` íŒŒì¼ - ë¡œì»¬ í™˜ê²½ ë³€ìˆ˜
3. ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸
4. API Secret Keys

### âœ… GitHubì— ì»¤ë°‹í•´ë„ ë¨:

1. `SUPABASE_ANON_KEY` - ê³µê°œ í‚¤ (ë‹¨, RLSë¡œ ë³´í˜¸ëœ ê²½ìš°)
2. `SUPABASE_URL` - í”„ë¡œì íŠ¸ URL
3. `.env.example` - ì˜ˆì‹œ íŒŒì¼ (ì‹¤ì œ ê°’ ì—†ì´)

---

## ğŸ“‹ ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

ë°°í¬ ì „ ë‹¤ìŒ í•­ëª©ì„ í™•ì¸í•˜ì„¸ìš”:

- [ ] `.gitignore`ì— `.env`, `.env.local` í¬í•¨ í™•ì¸
- [ ] `SUPABASE_SERVICE_ROLE_KEY`ê°€ ì½”ë“œì— í•˜ë“œì½”ë”©ë˜ì§€ ì•Šì•˜ëŠ”ì§€ í™•ì¸
- [ ] Supabase RLS í™œì„±í™” (ì„ íƒì‚¬í•­ì´ì§€ë§Œ ê¶Œì¥)
- [ ] Storage ë²„í‚· ì •ì±… ì„¤ì •
- [ ] Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì™„ë£Œ
- [ ] Edge Functions í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì™„ë£Œ
- [ ] GitHub ì €ì¥ì†Œê°€ Publicì´ë¼ë©´ ë¯¼ê°í•œ ì •ë³´ ì œê±° í™•ì¸

---

## ğŸ”„ í‚¤ ìœ ì¶œ ì‹œ ëŒ€ì‘

ë§Œì•½ API í‚¤ê°€ GitHubì— ë…¸ì¶œë˜ì—ˆë‹¤ë©´:

### 1ë‹¨ê³„: í‚¤ ì¦‰ì‹œ ë¬´íš¨í™”

1. Supabase ëŒ€ì‹œë³´ë“œ â†’ Settings â†’ API
2. "Reset" ë²„íŠ¼ í´ë¦­í•˜ì—¬ ìƒˆ í‚¤ ìƒì„±

### 2ë‹¨ê³„: Git íˆìŠ¤í† ë¦¬ì—ì„œ ì œê±°

```bash
# BFG Repo-Cleaner ì„¤ì¹˜
brew install bfg  # macOS
# ë˜ëŠ”
apt-get install bfg  # Linux

# ë¯¼ê°í•œ íŒŒì¼ ì œê±°
bfg --delete-files info.tsx

# Git íˆìŠ¤í† ë¦¬ ì •ë¦¬
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# ê°•ì œ í‘¸ì‹œ
git push origin --force --all
```

### 3ë‹¨ê³„: ìƒˆ í‚¤ë¡œ ì—…ë°ì´íŠ¸

1. ë¡œì»¬ `.env.local` ì—…ë°ì´íŠ¸
2. Vercel í™˜ê²½ ë³€ìˆ˜ ì—…ë°ì´íŠ¸
3. Edge Functions Secrets ì—…ë°ì´íŠ¸

---

## ğŸ“š ì¶”ê°€ ìë£Œ

- [Supabase RLS ê°€ì´ë“œ](https://supabase.com/docs/guides/auth/row-level-security)
- [Supabase Storage ë³´ì•ˆ](https://supabase.com/docs/guides/storage/security/access-control)
- [Vercel í™˜ê²½ ë³€ìˆ˜](https://vercel.com/docs/projects/environment-variables)

---

## ğŸ’¡ Best Practices

1. **í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©**: ëª¨ë“  ë¯¼ê°í•œ ì •ë³´ëŠ” í™˜ê²½ ë³€ìˆ˜ë¡œ ê´€ë¦¬
2. **RLS í™œì„±í™”**: ë°ì´í„°ë² ì´ìŠ¤ ë ˆë²¨ ë³´ì•ˆ ê°•í™”
3. **Private ì €ì¥ì†Œ**: ê°€ëŠ¥í•˜ë©´ Private ì €ì¥ì†Œ ì‚¬ìš©
4. **ì •ê¸°ì  í‚¤ êµì²´**: 3-6ê°œì›”ë§ˆë‹¤ API í‚¤ êµì²´
5. **ìµœì†Œ ê¶Œí•œ ì›ì¹™**: í•„ìš”í•œ ê¶Œí•œë§Œ ë¶€ì—¬
